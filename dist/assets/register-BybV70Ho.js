import{r as n,i as S,c as i,o as u,b as o,d as v,t as g,w as y,v as w,F as T,g as j}from"./runtime-dom.esm-bundler-DqGBW4yU.js";import{_ as I}from"./logo-CxXS7KxG.js";const M={class:"container"},b={class:"form-opts"},R={key:0,class:"error"},q={key:1,class:"success"},G={class:"form"},N={key:0,class:"error"},O={key:1,class:"success"},V="648082753611-avdkjg12avmnjhkug73j7asfsd9gef7e.apps.googleusercontent.com",P={__name:"RegisterComponent",setup(x){const c=n(""),l=n(""),d=n(""),s=n(""),m=n(""),p=n(""),f=n("");let k;S(()=>{k=google.accounts.oauth2.initTokenClient({client_id:V,scope:"profile email",callback:async a=>{const e=a.access_token,t=await fetch("/api/google",{method:"POST",body:JSON.stringify({token:e}),headers:{"Content-Type":"application/json"}});if(!t.ok)return p.value="Error al iniciar con Google";const r=await t.json();if(!r.success)return p.value="Error al iniciar con Google";const E=r.token;localStorage.setItem("token",E),f.value="Redirigiendo..."}})});function h(){if(!k){console.error("Google client no inicializado");return}k.requestAccessToken()}async function _(){if(c.value=="")return s.value="Introduce un email";if(l.value=="")return s.value="Introduce una contraseña";if(d.value=="")return s.value="Repite la contraseña";if(d.value!==l.value)return s.value="Las contraseñas no coinciden";try{const a=await fetch("/api/register",{method:"POST",body:JSON.stringify({email:c.value,password:l.value}),headers:{"Content-Type":"application/json"}});if(a.status>401)return s.value="Error interno. Por favor intente de nuevo";const e=await a.json();if(e.success){s.value="";const r=e.token;localStorage.setItem("token",r),m.value="Redirigiendo..."}else{const r={already_used:"El correo ya esta en uso"},C=e.message||"unknown";s.value=r[C]}}catch(a){s.value="Error al procesar la solicitud.",console.error(a.message)}}return(a,e)=>(u(),i(T,null,[e[8]||(e[8]=o("div",{class:"logo"},[o("img",{src:I,alt:"logo",height:"65px"})],-1)),o("div",M,[e[7]||(e[7]=o("div",{class:"register-info"},[o("h4",null,"Registrate para empezar"),o("a",{href:"/login.html"},"¿Ya tienes cuenta? Inicia sesion aquí")],-1)),o("div",b,[p.value?(u(),i("div",R,g(p.value),1)):v("",!0),f.value?(u(),i("div",q,g(f.value),1)):v("",!0),o("a",{class:"google-btn",onClick:h},"Continua con Google"),e[6]||(e[6]=o("div",{class:"separator"},[o("div"),o("span",null,"O"),o("div")],-1)),o("div",G,[o("div",null,[e[3]||(e[3]=o("h3",null,"Correo",-1)),y(o("input",{type:"email","onUpdate:modelValue":e[0]||(e[0]=t=>c.value=t),placeholder:"",required:"",id:"email"},null,512),[[w,c.value]])]),o("div",null,[e[4]||(e[4]=o("h3",null,"Contraseña",-1)),y(o("input",{type:"password","onUpdate:modelValue":e[1]||(e[1]=t=>l.value=t),placeholder:"",required:"",id:"password"},null,512),[[w,l.value]])]),o("div",null,[e[5]||(e[5]=o("h3",null,"Repita la contraseña",-1)),y(o("input",{type:"password","onUpdate:modelValue":e[2]||(e[2]=t=>d.value=t),placeholder:"",required:"",id:"password"},null,512),[[w,d.value]])]),s.value?(u(),i("div",N,g(s.value),1)):v("",!0),m.value?(u(),i("div",O,g(m.value),1)):v("",!0),o("button",{onClick:_},"Crear")])])])],64))}};j(P).mount("#register-app");
