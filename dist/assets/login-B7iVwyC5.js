import{r,i as E,c as l,o as i,b as o,d as g,t as v,w as _,v as y,F as I,g as S}from"./runtime-dom.esm-bundler-DqGBW4yU.js";import{_ as T}from"./logo-CxXS7KxG.js";const j={class:"container"},M={class:"form-opts"},b={key:0,class:"success"},N={key:1,class:"error"},G={class:"form"},O={key:0,class:"error"},q={key:1,class:"success"},x="648082753611-avdkjg12avmnjhkug73j7asfsd9gef7e.apps.googleusercontent.com",V={__name:"LoginComponent",setup(B){const c=r(""),u=r(""),s=r(""),d=r(""),p=r(""),m=r("");let f;E(()=>{f=google.accounts.oauth2.initTokenClient({client_id:x,scope:"profile email",callback:async n=>{const e=n.access_token,t=await fetch("/api/google",{method:"POST",body:JSON.stringify({token:e}),headers:{"Content-Type":"application/json"}});if(!t.ok)return d.value="Error al iniciar con Google";const a=await t.json();if(!a.success)return d.value="Error al iniciar con Google";const C=a.token;localStorage.setItem("token",C),p.value="Redirigiendo..."}})});function h(){if(!f){console.error("Google client no inicializado");return}f.requestAccessToken()}async function w(){if(c.value=="")return s.value="Introduce un email";if(u.value=="")return s.value="Introduce una contraseña";try{const n=await fetch("/api/login",{method:"POST",body:JSON.stringify({email:c.value,password:u.value}),headers:{"Content-Type":"application/json"}});if(n.status==500){s.value="Error interno. Por favor intente de nuevo";return}const e=await n.json();if(e.success){s.value="";const a=e.token;localStorage.setItem("token",a),m.value="Redirigiendo..."}else{const a={invalid_password:"Contraseña incorrecta",email_not_found:"El correo no existe",unknown:"Error desconocido. Intente de nuevo"},k=e.message||"unknown";s.value=a[k]}}catch(n){s.value="Error al procesar la solicitud.",console.error(n.message)}}return(n,e)=>(i(),l(I,null,[e[6]||(e[6]=o("div",{class:"logo"},[o("img",{src:T,alt:"logo",height:"65px"})],-1)),o("div",j,[e[5]||(e[5]=o("div",{class:"register-info"},[o("h4",null,"Inicia sesión"),o("a",{href:"/register.html"},"¿No tienes cuenta? Registrate aquí")],-1)),o("div",M,[p.value?(i(),l("div",b,v(p.value),1)):g("",!0),d.value?(i(),l("div",N,v(d.value),1)):g("",!0),o("a",{class:"google-btn",onClick:h},"Continua con Google"),e[4]||(e[4]=o("div",{class:"separator"},[o("div"),o("span",null,"O"),o("div")],-1)),o("div",G,[o("div",null,[e[2]||(e[2]=o("h3",null,"Correo",-1)),_(o("input",{type:"email","onUpdate:modelValue":e[0]||(e[0]=t=>c.value=t),placeholder:"",required:"",id:"email"},null,512),[[y,c.value]])]),o("div",null,[e[3]||(e[3]=o("h3",null,"Contraseña",-1)),_(o("input",{type:"password","onUpdate:modelValue":e[1]||(e[1]=t=>u.value=t),placeholder:"",required:"",id:"password"},null,512),[[y,u.value]])]),s.value?(i(),l("div",O,v(s.value),1)):g("",!0),m.value?(i(),l("div",q,v(m.value),1)):g("",!0),o("button",{onClick:w},"Entrar")])])])],64))}};S(V).mount("#login-app");
